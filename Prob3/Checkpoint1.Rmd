---
title: "Problema 3 - Checkpoint 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


O objetivo deste documento é fazer uma breve análise a respeito de alguns dados adiquiridos sobre emendas parlamentares. Emendas são custeios requisitados por parlamentares para a execução de algum projeto. Esses projetos são destinados para uma ciadade específica e podem ser classificados em diferentes funções.

Nesta análise, estaremos explorando dados referentes as ementas aprovados para estados da região norte, destinadas a categoria Saúde.
``` {r, include=FALSE}
require(ggplot2)
library(ggfortify)
require(data.table)

categorias <- c('Saúde')
norte <- c('RR','AP', 'AM', 'PA', 'AC', 'RO','TO')

em_det <- read.csv("emendas_detalhes_parlamentar.csv", sep = ",", header = T, stringsAsFactors=FALSE)


em_det <- subset(em_det, em_det$funcao.imputada %in% categorias)


em_det["TIPO"] <- NA
em_det$TIPO[grepl("CONSTRUÇÃO", em_det$OBJETO_PROPOSTA )] <- "Construção"
em_det$TIPO[grepl("AQUISIÇÃO", em_det$OBJETO_PROPOSTA)] <- "Aquisição"
em_det$TIPO[grepl("CAPACITAÇÃO", em_det$OBJETO_PROPOSTA)] <- "Capacitação"
em_det$TIPO[grepl("CONTRUÇÃO", em_det$OBJETO_PROPOSTA)] <- "Construção"
em_det$TIPO[grepl("REFORMA", em_det$OBJETO_PROPOSTA) | grepl("MANUTENÇÃO", em_det$OBJETO_PROPOSTA) | grepl("AMPLIAÇÃO", em_det$OBJETO_PROPOSTA) | grepl("CONCLUSÃO", em_det$OBJETO_PROPOSTA)] <- "Ampliação, manutenção, reforma ou conclusão"


em_det$DIA_INIC_VIGENCIA_PROPOSTA <- as.Date(em_det$DIA_INIC_VIGENCIA_PROPOSTA, "%d/%m/%Y")
em_det$DIA_FIM_VIGENCIA_PROPOSTA <- as.Date(em_det$DIA_FIM_VIGENCIA_PROPOSTA , "%d/%m/%Y")
em_det["DIAS"] <- NA
em_det$DIAS <- as.numeric( em_det$DIA_FIM_VIGENCIA_PROPOSTA - em_det$DIA_INIC_VIGENCIA_PROPOSTA )


norte <- subset(em_det, em_det$UF_PROPONENTE %in% norte)
norte.k <- data.frame(norte$DIAS, norte$VALOR_REPASSE_EMENDA)

```


```{r}

ggplot(norte, aes(DIAS, VALOR_REPASSE_EMENDA)) + 
      geom_point(position = position_jitter(width = .1), alpha = .4)

ggplot(norte, aes(DIAS, VALOR_REPASSE_EMENDA, color = NATUREZA_JURIDICA )) + 
      geom_point(position = position_jitter(width = .1), alpha = .4)


ggplot(norte, aes(DIAS, VALOR_REPASSE_EMENDA, color = TIPO )) + 
      geom_point(position = position_jitter(width = .1), alpha = .4)


d<- dist(scale(norte.k))
hc <- hclust(d, method="average")
cluster_complete <- cutree(hc, k=6)
plot(scale(norte.k), col=cluster_complete)
```
